<%- include('../common/headers.ejs') %>
<link rel="stylesheet" href="/adminCheckInModule/checkIn/checkIn.css" />
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"
></script>
<script defer src="/adminCheckInModule/checkIn/checkIn.js"></script>

<title>Passenger Check In</title>
<div class="header-container">
  <div onclick="changeDate('prev')"><span class="material-icons material-chevron">arrow_back_ios</span></div>
  <div id="date"></div>
  <div onclick="changeDate('next')"><span class="material-icons material-chevron">arrow_forward_ios</span></div>
</div>

<div class="input-container">
  <div class="trip-container">
    <label for="from-location">TRIP</label>
    <div>
      <select id="from-location">
        <option disabled selected value>Select Start Location</option>
        <option>CARMONA</option>
        <option>DLSU MNL</option>
        <option>DLSU LAG</option>
        <option>PASEO</option>
        <option>PAVILION</option>
        <option>WALTER</option>
      </select>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
      >
        <path
          d="M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z"
          fill="black"
        />
      </svg>
      <select id="to-location">
        <option disabled selected value>Select Destination</option>
        <option>CARMONA</option>
        <option>DLSU MNL</option>
        <option>DLSU LAG</option>
        <option>PASEO</option>
        <option>PAVILION</option>
        <option>WALTER</option>
      </select>
    </div>
  </div>
  <div class="time-container">
    <label for="time-select">TIME</label>
    <select id="time-select">
      <option disabled selected value>Select Time</option>
    </select>
  </div>
  <div class="information-container">
    <label>SEATS</label>
    <div>
      <div><span id="reserved-seats"></span></div>
      <div><span id="currently-present"></span></div>
      <div><span id="walk-in"></span></div>
    </div>
    <div>
      <div>reserved seats</div>
      <div>currently present</div>
      <div>available for walk-in</div>
    </div>
  </div>
</div>
<div class="passenger-list-container">
  <div id="initial-message">
    Select a trip and time for this date to view list of reservations
  </div>
  <div>
    <div class="action-container">
      <div class="search-container">
        <input id="search" placeholder="Search name or ID" />
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M15.755 14.255H14.965L14.685 13.985C15.665 12.845 16.255 11.365 16.255 9.755C16.255 6.165 13.345 3.255 9.755 3.255C6.165 3.255 3.255 6.165 3.255 9.755C3.255 13.345 6.165 16.255 9.755 16.255C11.365 16.255 12.845 15.665 13.985 14.685L14.255 14.965V15.755L19.255 20.745L20.745 19.255L15.755 14.255ZM9.755 14.255C7.26501 14.255 5.255 12.245 5.255 9.755C5.255 7.26501 7.26501 5.255 9.755 5.255C12.245 5.255 14.255 7.26501 14.255 9.755C14.255 12.245 12.245 14.255 9.755 14.255Z"
            fill="#030712"
          />
        </svg>
      </div>

      <button id="scan">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M9.5 6.5V9.5H6.5V6.5H9.5ZM11 5H5V11H11V5ZM9.5 14.5V17.5H6.5V14.5H9.5ZM11 13H5V19H11V13ZM17.5 6.5V9.5H14.5V6.5H17.5ZM19 5H13V11H19V5ZM13 13H14.5V14.5H13V13ZM14.5 14.5H16V16H14.5V14.5ZM16 13H17.5V14.5H16V13ZM13 16H14.5V17.5H13V16ZM14.5 17.5H16V19H14.5V17.5ZM16 16H17.5V17.5H16V16ZM17.5 14.5H19V16H17.5V14.5ZM17.5 17.5H19V19H17.5V17.5ZM22 7H20V4H17V2H22V7ZM22 22V17H20V20H17V22H22ZM2 22H7V20H4V17H2V22ZM2 2V7H4V4H7V2H2Z"
            fill="white"
          />
        </svg>
        Scan QR
      </button>
    </div>

    <div id="passenger-list-container"></div>
  </div>
</div>

<script>
  // Get query
  const params = new Proxy(new URLSearchParams(window.location.search), {
    get: (searchParams, prop) => searchParams.get(prop),
  })
  const { date, from, to, time, error } = params

  let passengerList = []
  let slotCount = 0
  let reservedCount = 0
  let presentCount = 0
  let walkInCount = 0
  if (from && to && time) {
    slotCount = JSON.parse('<%- JSON.stringify(slotCount) %>')
    reservedCount = JSON.parse('<%- JSON.stringify(reservedCount) %>')
    presentCount = JSON.parse('<%- JSON.stringify(presentCount) %>')
    walkInCount = JSON.parse('<%- JSON.stringify(walkInCount) %>')
    passengerList = JSON.parse('<%- JSON.stringify(passengerList) %>')
  }
</script>
